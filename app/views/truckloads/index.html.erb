<div class="text-center">
  <h4><%= t('.list') %>: <%= current_user.first_name %></h4>
</div>
<div class="card shadow mb-4">
  <div class="card-body">
    <div class="table-responsive">
      <div class="row">
        <div class="col-sm-12">
          <table id="table" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th><%= t('.dt_number') %></th>
                <th><%= t('.client') %></th>
                <th><%= t('.value') %></th>
                <th><%= t('.is_agent') %>?</th>
                <th><%= t('.created_at') %></th>
                <th><%= t('.cte') %></th>
                <th><%= t('.qtd_cte') %></th>
                <th class="no-sort table-buttons">
                  <%= link_to new_truckload_path(@truckload), class: 'btn btn-success btn-circle' do %>
                    <i class="fas fa-plus"></i>
                  <% end %>
                </th>
            </thead>
            <tbody>
              <% @truckloads.each do |truckload| %>
                <tr role="row" class="odd">
                  <td><%= truckload.dt_number %></td>
                  <td><%= truckload.client.company_name %> - <%= truckload.client.address.state %> | <%= truckload.client.document_number.to_br_cnpj %></td>
                  <td><%= number_to_currency(truckload.truckload_value) %></td>
                  <td><%= is_agent(truckload.is_agent) %></td>
                  <td><%= l(truckload.created_at, format: '%d/%m/%Y Ã s %H:%M') %></td>
                  <% if truckload.cte.present? %>
                    <td>
                      <a href="#" data-toggle="modal" data-target="#truckload-<%= truckload.id %>">
                        <%= t('.view_cte') %>
                      </a>
                      <div id="truckload-<%= truckload.id %>" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h4 class="modal-title"><%= t('.linked_cte') %>: <%= truckload.dt_number %></h4>
                              <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                            <div class="modal-body">
                            <% truckload.cte.each do |cte| %>
                              <%= link_to cte_path(cte.id) do %>
                                <li><%= cte.cte_number %> - <%= number_to_currency(cte.value) %></li>
                              <% end %>
                            <% end %>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-dark" data-dismiss="modal"><%= t('.close') %></button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </td>
                  <% else %>
                    <td><%= t('.no_cte') %></td>
                  <% end %>
                  <td><%= truckload.ctes_numbers.count %></td>
                  <td>
                    <%= link_to truckload_path(truckload), class: 'btn btn-dark' do %>
                      <i class="fas fa-eye"></i>
                    <% end %>
                    <%= link_to edit_truckload_path(truckload), class: 'btn btn-info btn-circle' do %>
                      <i class="fas fa-edit"></i>
                    <% end %>
                    <%= link_to truckload_path(truckload), method: :delete, class: 'btn btn-danger btn-circle', data: { confirm: "#{t('.delete_confirm')}: #{truckload.dt_number}?"} do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <% if @truckloads.empty? %>
    <tr><%= t('.no_data') %></tr>
  <% end %>
</div>
